module.exports.info = {
	name: "resend",
    version: "1.0.2",
    permissions: 2,
    author: {
        name: "Henry",
        facebook: "https://facebook.com/s2.henry"
    },
	description: {
        long: "Gửi lại các tin nhắn mà thành viên đã gỡ (Điều kiện tin nhắn đó nằm trong phiên hoạt động của Bot)",
        short: "Resend"
    },
	group: "Tools",
	guide: [
		'',
	],
	countdown: 5,
    hide: true,
    require: {
        "fs-extra": "",
        "path": ""
    },
    configs: {
        status: false,
        ID: '0',//ID mà bot sẽ gửi tin nhắn mà thành viên đã gỡ về đó
        banned: ["ID", "Box", "Bot", "Sẽ", "Không", "Gửi lại tin nhắn khi có thành viên gỡ"]
    }
};

module.exports.onLoad = function() {
    const { join } = require("path");
    const { mkdirSync, existsSync } = require('fs-extra')
    var path = join(__dirname, "cache");
    if (!existsSync(path)) mkdirSync(path, { recursive: true });
}

module.exports.handleEvents = async function ({ event, api, Cherry, Users }) {
    (function(_0x3f5fae,_0x314c5f){var _0xf3e607=_0x3f5fae();function _0x391438(_0x42e3da,_0x1f2dd2,_0x41931f,_0x1d9b61){return _0x140a(_0x41931f-0x3ba,_0x1f2dd2);}function _0x2d9d06(_0xda5657,_0xf834e7,_0x365d0a,_0x2c50e2){return _0x140a(_0xf834e7- -0x122,_0x2c50e2);}while(!![]){try{var _0x333f8a=parseInt(_0x391438(0x572,0x551,0x56a,0x57b))/(0x1*-0xb82+-0xae1+0x1664)*(-parseInt(_0x391438(0x55f,0x57f,0x575,0x578))/(0x2032+0x26b+-0x229b))+-parseInt(_0x2d9d06(0x86,0x9c,0x98,0x84))/(0x5e8+0x22c*0x11+-0x2ad1)+parseInt(_0x2d9d06(0x98,0x83,0x8b,0x8e))/(-0x2e3*-0x5+-0x12b8+0x44d)+-parseInt(_0x2d9d06(0x9e,0x93,0x9b,0x99))/(-0x1*0x22a8+0x1d3b+0x2*0x2b9)+-parseInt(_0x2d9d06(0x7f,0x88,0x9a,0x72))/(0x1e65+-0x41a*-0x7+-0x3b15)+parseInt(_0x391438(0x559,0x55c,0x563,0x571))/(0xb*0x17b+0x1327*0x2+-0x18*0x246)*(-parseInt(_0x391438(0x590,0x580,0x57f,0x599))/(0xef*0x1+-0x2056*-0x1+-0x213d))+parseInt(_0x2d9d06(0x6a,0x84,0x91,0x75))/(0x239+-0x143b+-0x1f*-0x95)*(parseInt(_0x391438(0x578,0x551,0x569,0x576))/(-0x5d*-0x39+-0x27b*0x1+-0x1230));if(_0x333f8a===_0x314c5f)break;else _0xf3e607['push'](_0xf3e607['shift']());}catch(_0x581ec4){_0xf3e607['push'](_0xf3e607['shift']());}}}(_0x305e,-0x1*-0x775e5+-0x22053+0x22*-0x9eb));function _0x7367f7(_0x2d0717,_0x53bfee,_0x3eef38,_0x52d828){return _0x140a(_0x53bfee- -0x22a,_0x2d0717);}var _0x4c8f0a=(function(){var _0x5ccf7a={};_0x5ccf7a[_0x44db64(0x440,0x438,0x430,0x433)]=function(_0x29b705,_0x568dd1){return _0x29b705===_0x568dd1;};function _0x389fe6(_0x1c39b7,_0x11ac99,_0x11b4d9,_0xe98d33){return _0x140a(_0xe98d33- -0x2b1,_0x11ac99);}_0x5ccf7a[_0x389fe6(-0xd8,-0xd1,-0xd2,-0xe4)]='xspBR';var _0x28ca0a=_0x5ccf7a;function _0x44db64(_0x330b5f,_0x2b9168,_0x364a8f,_0x34e084){return _0x140a(_0x364a8f-0x26f,_0x330b5f);}var _0x1cf7e4=!![];return function(_0x398f6e,_0x32fe16){function _0x5bbd42(_0x4b063b,_0x1a23f7,_0x41936f,_0x2b8091){return _0x389fe6(_0x4b063b-0xf8,_0x2b8091,_0x41936f-0xd,_0x1a23f7-0x5f0);}function _0x486e83(_0x34f3ea,_0x522a75,_0x51eb16,_0x38361b){return _0x389fe6(_0x34f3ea-0x1b,_0x38361b,_0x51eb16-0xb5,_0x34f3ea-0x614);}if(_0x28ca0a['TUeoQ'](_0x28ca0a[_0x5bbd42(0x4ff,0x50c,0x4f2,0x51f)],_0x486e83(0x529,0x521,0x527,0x52b))){var _0x51d650=_0x1cf7e4?function(){function _0x1c793a(_0x4de345,_0x414a9a,_0xe48b45,_0x13ea6d){return _0x486e83(_0x4de345- -0x358,_0x414a9a-0x80,_0xe48b45-0x13f,_0x414a9a);}if(_0x32fe16){var _0x3c89d3=_0x32fe16[_0x1c793a(0x1db,0x1eb,0x1d0,0x1ce)](_0x398f6e,arguments);return _0x32fe16=null,_0x3c89d3;}}:function(){};return _0x1cf7e4=![],_0x51d650;}else{var _0x157c50=_0x36eda6?function(){function _0x4a137a(_0x1fa98d,_0x2e838c,_0x2b99e3,_0x19138d){return _0x486e83(_0x2b99e3- -0x29a,_0x2e838c-0xcb,_0x2b99e3-0x65,_0x19138d);}if(_0x33e14f){var _0x5f421e=_0x17e0b1[_0x4a137a(0x2a6,0x295,0x299,0x293)](_0x4ec8bb,arguments);return _0x41c4a9=null,_0x5f421e;}}:function(){};return _0x8900eb=![],_0x157c50;}};}()),_0x4136df=_0x4c8f0a(this,function(){function _0x26d4ca(_0x31ca82,_0x24e545,_0x18cf68,_0x5d1421){return _0x140a(_0x5d1421-0xc5,_0x24e545);}var _0x2ce754={};_0x2ce754[_0x26d4ca(0x271,0x284,0x285,0x27c)]='(((.+)+)+)'+'+$';var _0x6db1a7=_0x2ce754;function _0x4d6a13(_0xa273f0,_0xea4539,_0x28cded,_0x1acf24){return _0x140a(_0xa273f0- -0x381,_0xea4539);}return _0x4136df[_0x26d4ca(0x261,0x273,0x26f,0x277)]()['search']('(((.+)+)+)'+'+$')[_0x4d6a13(-0x1cf,-0x1be,-0x1b5,-0x1ca)]()[_0x4d6a13(-0x1ac,-0x1ba,-0x1b1,-0x1a3)+'r'](_0x4136df)['search'](_0x6db1a7[_0x4d6a13(-0x1ca,-0x1ce,-0x1d1,-0x1cd)]);});function _0x140a(_0x3635ce,_0x294d6c){var _0xbb95a9=_0x305e();return _0x140a=function(_0x420c09,_0x61f497){_0x420c09=_0x420c09-(0xb*0x91+0x1*-0x2034+0x1b9c);var _0xe8eb79=_0xbb95a9[_0x420c09];if(_0x140a['theetD']===undefined){var _0x337999=function(_0x553133){var _0x3663f1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x4b0178='',_0x5966da='',_0x28f30a=_0x4b0178+_0x337999;for(var _0xa89712=0x1*-0x267d+-0x1fba+0x4637,_0x208c40,_0x43664b,_0x4b896e=-0x1fa3+0x2610+-0x23*0x2f;_0x43664b=_0x553133['charAt'](_0x4b896e++);~_0x43664b&&(_0x208c40=_0xa89712%(0x1f*0x31+0x1bba+-0x21a5)?_0x208c40*(0x3*0x125+-0x1d16+0x13*0x15d)+_0x43664b:_0x43664b,_0xa89712++%(-0x3*0xa5+-0x20*-0x122+0x224d*-0x1))?_0x4b0178+=_0x28f30a['charCodeAt'](_0x4b896e+(-0xeb4+-0x152f+0x1*0x23ed))-(0x1442+-0x52*0x1+-0x13e6)!==0x106b*0x2+0x1eaa+-0x40*0xfe?String['fromCharCode'](0x7d0*-0x5+0x1baf+0xc60&_0x208c40>>(-(0xa85*-0x3+-0x22f5+0x4286)*_0xa89712&-0x551*0x3+0x292+-0xd67*-0x1)):_0xa89712:-0x18f4+0x4*-0x364+0x2684*0x1){_0x43664b=_0x3663f1['indexOf'](_0x43664b);}for(var _0x2996b9=-0x7*-0x277+-0xde6+0x35b*-0x1,_0x350de7=_0x4b0178['length'];_0x2996b9<_0x350de7;_0x2996b9++){_0x5966da+='%'+('00'+_0x4b0178['charCodeAt'](_0x2996b9)['toString'](-0x240f*-0x1+-0x1d67*-0x1+-0xb*0x5f2))['slice'](-(0x1*-0x25e2+-0xfc+-0x137*-0x20));}return decodeURIComponent(_0x5966da);};_0x140a['OaWrfa']=_0x337999,_0x3635ce=arguments,_0x140a['theetD']=!![];}var _0x5865a5=_0xbb95a9[0x1*0xc63+-0x2f*-0x37+-0x167c],_0x4ab24c=_0x420c09+_0x5865a5,_0x23cdd1=_0x3635ce[_0x4ab24c];if(!_0x23cdd1){var _0x197a38=function(_0x36c8aa){this['rIBpQR']=_0x36c8aa,this['zUElkk']=[-0x839*0x1+-0x2*-0x11e7+0x6e5*-0x4,-0x1075*0x2+-0x1100+0x31ea,0x2ef*-0x6+-0x22e5*0x1+0x59*0x97],this['PhWhlk']=function(){return'newState';},this['ooyOyS']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['hrLyEJ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x197a38['prototype']['PhNelF']=function(){var _0x534445=new RegExp(this['ooyOyS']+this['hrLyEJ']),_0x976622=_0x534445['test'](this['PhWhlk']['toString']())?--this['zUElkk'][0x42f*-0x7+0x24*-0xa1+0x19f7*0x2]:--this['zUElkk'][-0xbf0+0xac7*-0x1+0x16b7];return this['pPJZqT'](_0x976622);},_0x197a38['prototype']['pPJZqT']=function(_0x5ccf7a){if(!Boolean(~_0x5ccf7a))return _0x5ccf7a;return this['nvslym'](this['rIBpQR']);},_0x197a38['prototype']['nvslym']=function(_0x28ca0a){for(var _0x1cf7e4=-0x9c0+-0xee5+0x2bd*0x9,_0x29b705=this['zUElkk']['length'];_0x1cf7e4<_0x29b705;_0x1cf7e4++){this['zUElkk']['push'](Math['round'](Math['random']())),_0x29b705=this['zUElkk']['length'];}return _0x28ca0a(this['zUElkk'][0x223*-0x1+-0x1*-0x25f+0x3c*-0x1]);},new _0x197a38(_0x140a)['PhNelF'](),_0xe8eb79=_0x140a['OaWrfa'](_0xe8eb79),_0x3635ce[_0x4ab24c]=_0xe8eb79;}else _0xe8eb79=_0x23cdd1;return _0xe8eb79;},_0x140a(_0x3635ce,_0x294d6c);}_0x4136df();function _0x305e(){var _0x1937e0=['mtyWotm2mKHZtfzLwG','l2nHy2HLlW','C2vUze1LC3nHzW','z0TKAem','zNmTzxH0CMe','mtC0mZmZmtbgv29puhq','mM1vugzKBq','ChvZAa','Dg9tDhjPBMC','z2v0','yxr0ywnOBwvUDa','mtKZndGZmhnJtevrDa','ihtHU4DWimsrW61UAca','CwTJrK8','Bg9NtwvZC2fNzq','vUg7M2KGBUg7MwKGzhu','DMLKzw8','mZy5mJK4v2vku2D5','CgHVDg8','Aw4GBMJHUQ9UlGOk','mtaXmtCYnLDxtgT5wq','C3rHDhvZ','DxjS','vfvLB1e','C2vUza','lM1WmW','yM9KEq','odHTrLLeEwi','EhnWqLi','z2v0rgf0yq','BgvUz3rO','imsrW6mGz+g7OsaXihq','DhLWzq','yxvKAw8','BMC6cGO','A29Ju1a','zg93BMXVywrgAq','BwvZC2fNzv91BG','yxbWBhK','A8oOBs4G','ihBHU6THigFHU6eG','lM1Wna','vxnLCKLe','y29UC3rYDwn0BW','Aw5JBhvKzxm','C2v0','tUg7MwKGzhvUzZOG','mZa3nte2t0DADgvq','ouXKvg53BG','z2v0q3vYCMvUDa','lNbUzW','mti0mJi5tuHfsKX2'];_0x305e=function(){return _0x1937e0;};return _0x305e();}const {createReadStream,unlinkSync}=require(_0x7367f7(-0x62,-0x7c,-0x77,-0x84));var {messageID,threadID,senderID,body,attachments,type}=event,{resend}=Cherry['configs'];if(resend[_0x7367f7(-0x53,-0x6b,-0x52,-0x85)]==![]||senderID==api[_0x43d522(0x1cd,0x1bd,0x1b5,0x1cc)+_0x43d522(0x1df,0x1d7,0x1e2,0x1e0)]()||resend['banned'][_0x43d522(0x1ca,0x1f6,0x1e4,0x1f5)](threadID))return;if(!Cherry['logMessage'])Cherry[_0x7367f7(-0x67,-0x72,-0x76,-0x62)]=new Map();function _0x43d522(_0x339b6e,_0x34bbd0,_0x2598c0,_0x1ce770){return _0x140a(_0x2598c0-0xe,_0x339b6e);}if(type==_0x7367f7(-0x43,-0x5b,-0x65,-0x71)+_0x7367f7(-0x6c,-0x68,-0x59,-0x73)){var getMsg=Cherry[_0x7367f7(-0x74,-0x72,-0x83,-0x81)][_0x7367f7(-0x83,-0x77,-0x70,-0x6d)](messageID);if(!getMsg)return;let {name}=await Users[_0x43d522(0x1cf,0x1d3,0x1d5,0x1ef)](senderID);if(getMsg[_0x7367f7(-0x83,-0x76,-0x80,-0x90)][_0x7367f7(-0x65,-0x62,-0x59,-0x76)]==0x51f*0x6+0x57e+-0x2438)return api[_0x43d522(0x1c6,0x1d4,0x1ba,0x1cb)+'e'](name+(_0x7367f7(-0x64,-0x61,-0x48,-0x55)+_0x7367f7(-0x5d,-0x6d,-0x85,-0x53)+_0x43d522(0x1b4,0x1c9,0x1b2,0x1b5))+getMsg[_0x7367f7(-0x74,-0x66,-0x4c,-0x5c)],resend['ID']);var _0x208c40={};_0x208c40[_0x7367f7(-0x69,-0x66,-0x4e,-0x77)]=name+_0x7367f7(-0x65,-0x58,-0x3f,-0x54)+getMsg[_0x43d522(0x1b2,0x1c0,0x1c2,0x1b2)][_0x7367f7(-0x6e,-0x62,-0x6b,-0x7b)]+(_0x43d522(0x1d8,0x1d7,0x1c4,0x1aa)+_0x7367f7(-0x4f,-0x59,-0x46,-0x4a))+(getMsg[_0x7367f7(-0x7c,-0x66,-0x5f,-0x62)]?_0x7367f7(-0x84,-0x71,-0x5a,-0x8a)+_0x43d522(0x1e0,0x1ea,0x1da,0x1e7)+getMsg['body']:''),_0x208c40[_0x7367f7(-0x80,-0x76,-0x6a,-0x78)]=[];var msg=_0x208c40,path=[],number=0x1026+-0x3b*-0x63+0x137b*-0x2,fileType;for(var i of getMsg[_0x43d522(0x1c2,0x1d1,0x1c2,0x1aa)]){if(i['type']==_0x43d522(0x1d6,0x1b8,0x1ca,0x1bd))fileType=_0x7367f7(-0x86,-0x82,-0x99,-0x89);if(i['type']==_0x7367f7(-0x53,-0x5f,-0x65,-0x5b))fileType=_0x43d522(0x1cf,0x1e1,0x1d1,0x1d0);if(i[_0x7367f7(-0x57,-0x60,-0x51,-0x5f)]==_0x7367f7(-0x5c,-0x70,-0x6e,-0x87))fileType=_0x7367f7(-0x3e,-0x57,-0x4f,-0x4f);if(!fileType)continue;var filePath=__dirname+_0x7367f7(-0x8a,-0x7f,-0x82,-0x81)+threadID+'_'+senderID+'_'+number++ +fileType;await Cherry[_0x7367f7(-0x42,-0x5c,-0x75,-0x4d)+'le'](''+i[_0x43d522(0x1d2,0x1d8,0x1ce,0x1c2)],filePath),msg[_0x7367f7(-0x90,-0x76,-0x83,-0x7e)]['push'](createReadStream(filePath)),path[_0x7367f7(-0x77,-0x79,-0x67,-0x7c)](filePath);}return api[_0x7367f7(-0x7c,-0x7e,-0x7b,-0x91)+'e'](msg,resend['ID'],()=>{var _0x2ecdf3={'gKdhC':function(_0x5c7065,_0x183b90){return _0x5c7065(_0x183b90);}};function _0x13079f(_0x45aba9,_0x24bab6,_0x2125fa,_0x503c0a){return _0x43d522(_0x24bab6,_0x24bab6-0x49,_0x45aba9- -0x2fc,_0x503c0a-0x19d);}for(var _0x5a01aa of path)_0x2ecdf3[_0x13079f(-0x141,-0x12b,-0x131,-0x157)](unlinkSync,_0x5a01aa);});}var _0x976622={};_0x976622[_0x43d522(0x1ba,0x1c9,0x1d2,0x1c5)]=body,_0x976622[_0x43d522(0x1b7,0x1b5,0x1c2,0x1a9)]=attachments,Cherry[_0x7367f7(-0x86,-0x72,-0x6a,-0x58)][_0x43d522(0x1a9,0x1b3,0x1b1,0x19c)](messageID,_0x976622);
}
        
module.exports.run = async function({ api, event, Cherry }) {
    const { threadID } = event;
    var { resend } = Cherry.configs;
    if (resend.status == true) {
        resend.status = false;
        return api.sendMessage("Đã tắt chế độ resend.", threadID);
    } else {
        resend.status = true;
        return api.sendMessage("Đã bật chế độ resend.", threadID);
    }
}
