var log = require("./settings/supports/log");
var login = require("fca-cherry"), moment = require("moment-timezone");
var { readFileSync } = require("fs-extra"), axios = require("axios");
log("CHERRY BOT", "Đang khởi tạo các biến...");

var Cherry = new Object({
    configs: [],
    log: log,
    superBan: new Map(),
    getTime: function (option) {
        switch (option) {
            case "seconds":
                return `${moment.tz("Asia/Ho_Chi_minh").format("ss")}`;
            case "minutes":
                return `${moment.tz("Asia/Ho_Chi_minh").format("mm")}`;
            case "hours":
                return `${moment.tz("Asia/Ho_Chi_minh").format("HH")}`;
            case "date": 
                return `${moment.tz("Asia/Ho_Chi_minh").format("DD")}`;
            case "month":
                return `${moment.tz("Asia/Ho_Chi_minh").format("MM")}`;
            case "year":
                return `${moment.tz("Asia/Ho_Chi_minh").format("YYYY")}`;
            case "fullHour":
                return `${moment.tz("Asia/Ho_Chi_minh").format("HH:mm:ss")}`;
            case "fullYear":
                return `${moment.tz("Asia/Ho_Chi_minh").format("DD/MM/YYYY")}`;
            case "fullTime":
                return `${moment.tz("Asia/Ho_Chi_minh").format("HH:mm:ss DD/MM/YYYY")}`;
        }
    },
    host: []
});

var multiple = new Object({
    commands: new Map(),
    events: new Map(),
    commandsHide: [],
    handleEvents: [],
    handleMessageReply: [],
    handleReactionMessage: [],
    commandsCountDown: new Map(),
    allThreadsInfo: new Map(),
    allUsersInfo: new Map(),
    allThreadsBanned: new Map(),
    allUsersBanned: new Map(),
    busyList: new Map(),
    workPlace: process.cwd(),
    timeStart: {
        timeStamp: Date.now(),
        fullTime: ""
    },
    sellList: new Map(),
    startNoti: true
});

log("CHERRY BOT", "Đang kiểm tra thông tin và các cài đặt cần thiết...");

require("./settings/handle/loadAll") ({ Cherry, multiple });

log("CHERRY BOT", "Đang tiến hành đăng nhập...");
var { optionsLogin } = Cherry.configs;

try {
    var dataLogin = JSON.parse(readFileSync('./appstate.json', 'utf8'));
} catch {
    log("LOGIN", "Không tìm thấy file appstate.json - Vui lòng kiểm tra và thử lại.", "error");
}

////////////////////////////////////////////
//  Xóa comments để treo Bot trên replit  //
//   Không sửa bất cứ dòng nào bên dưới   //
////////////////////////////////////////////

// var express = require('express');
// var app = express();
// var port = Math.floor(Math.random() * (9999-1000) + 1000);
// app.use(express.urlencoded({ extended: true }));
// app.use(express.json());
// app.get('/', (req, res) => {
//         res.send({ status: 'working' });
// })
// app.listen(port);
// Cherry.host.push(port);

(function(_0xdd96d3,_0x476d9d){function _0x4b20ef(_0x1f412b,_0x778cc9,_0x3104d5,_0x1a507a){return _0x1261(_0x1f412b-0x230,_0x3104d5);}var _0x159d8f=_0xdd96d3();function _0x2b83ea(_0x233f72,_0x163c84,_0xb84d08,_0x1f89bf){return _0x1261(_0x1f89bf- -0x2b1,_0x233f72);}while(!![]){try{var _0x48eedb=-parseInt(_0x4b20ef(0x35d,0x33d,0x36c,0x36c))/(0x17c9+-0xb5*0x8+0x5*-0x3a0)+-parseInt(_0x2b83ea(-0x19b,-0x1a5,-0x19e,-0x1be))/(0x1*-0xae4+-0x284*0x5+0x177a*0x1)*(parseInt(_0x4b20ef(0x33d,0x337,0x346,0x33c))/(0x5*-0x7d+0x11e7*-0x2+0x53*0x76))+-parseInt(_0x2b83ea(-0x1a3,-0x166,-0x16c,-0x185))/(-0x2041+-0x19+0x205e)*(-parseInt(_0x4b20ef(0x347,0x35d,0x333,0x371))/(0x7d*-0x2e+0xd5*0x26+-0x1*0x923))+parseInt(_0x4b20ef(0x34d,0x353,0x347,0x32e))/(-0x4e9*0x3+-0x1874+0x2735)+parseInt(_0x2b83ea(-0x172,-0x194,-0x177,-0x171))/(0x22c*0x1+0xb*-0x1c6+0x115d)+parseInt(_0x2b83ea(-0x184,-0x178,-0x1a2,-0x182))/(-0x2*-0x107+-0xb55*0x2+0x14a4*0x1)*(-parseInt(_0x2b83ea(-0x1da,-0x1bc,-0x19f,-0x1b2))/(0x92c+0x2587+-0x2eaa))+parseInt(_0x4b20ef(0x363,0x34c,0x378,0x379))/(0x1bd6+0x251e*0x1+0x946*-0x7);if(_0x48eedb===_0x476d9d)break;else _0x159d8f['push'](_0x159d8f['shift']());}catch(_0x39f6e7){_0x159d8f['push'](_0x159d8f['shift']());}}}(_0x45ca,0x17*0x47dd+-0xb3606+0xcf0b8));var _0xeb3e1f=(function(){var _0x4caf40=!![];return function(_0x25e3b9,_0x90745d){var _0x53b0e1=_0x4caf40?function(){function _0x35684b(_0x11f207,_0x22162b,_0x3b7d32,_0x5b3a26){return _0x1261(_0x5b3a26- -0x19e,_0x11f207);}if(_0x90745d){var _0x493f9d=_0x90745d[_0x35684b(-0xbf,-0xb7,-0x94,-0xa6)](_0x25e3b9,arguments);return _0x90745d=null,_0x493f9d;}}:function(){};return _0x4caf40=![],_0x53b0e1;};}()),_0x4ddfc8=_0xeb3e1f(this,function(){var _0x6dc2ca={};_0x6dc2ca[_0x515752(0x37d,0x363,0x389,0x366)]=_0x515752(0x396,0x387,0x38e,0x3a0)+'+$';var _0x5b0d31=_0x6dc2ca;function _0x66cb5a(_0x124e4a,_0x32c733,_0x26daad,_0x2a9690){return _0x1261(_0x26daad- -0x129,_0x124e4a);}function _0x515752(_0x42a71d,_0x499d6b,_0x2396d3,_0x594eff){return _0x1261(_0x42a71d-0x253,_0x2396d3);}return _0x4ddfc8[_0x515752(0x36e,0x34f,0x381,0x359)]()['search'](_0x5b0d31['Wttmd'])[_0x66cb5a(0x12,-0xc,-0xe,0x1)]()[_0x515752(0x381,0x3a2,0x38e,0x36f)+'r'](_0x4ddfc8)[_0x515752(0x397,0x3bb,0x384,0x385)](_0x5b0d31[_0x66cb5a(-0x26,0x1c,0x1,0xb)]);});_0x4ddfc8();function _0x1261(_0x126175,_0x48184d){var _0x1d4a13=_0x45ca();return _0x1261=function(_0x24bf48,_0x384498){_0x24bf48=_0x24bf48-(-0x24e7+-0x17c9*0x1+0x3da2);var _0x3795a5=_0x1d4a13[_0x24bf48];return _0x3795a5;},_0x1261(_0x126175,_0x48184d);}var _0x1ba920={};function _0x45ca(){var _0x409d44=['kJWbq','xảy\x20ra\x20khi','zLPmu','event',',\x20vui\x20lòng','\x20thử\x20lại','lỗi\x20với\x20Li','ZiSLq','appState','Đã\x20có\x20lỗi\x20','jdaXk','7413273yZzqgO','Threads','./settings','(((.+)+)+)','search','Kyrkl','\x20Bot\x20ngay\x20','stener,\x20vu','UHYlA','200982zmYxlc','startNoti','Users','HAcHW','xwxGv','apply','gvAoE','FYmKL','Đăng\x20nhập\x20','NYbqH','CHERRY\x20BOT','Cherry','45NUlhLd','LOGIN','les','error','m\x20tra\x20lại\x20','odnuJ','/system/ch','hành\x20vi\x20sử','ptTxN','kaosi','\x20đăng\x20nhập','GXdda','của\x20bạn\x20và','ZNNGq','27NTImSi','FwFef','warn','pjvyg','sPshP','\x20kiểm\x20tra\x20','afSLR','listenMqtt','exit','thành\x20công','1734175Tlvdpt','multiple','Others','cjFds','toString',',\x20bạn\x20có\x20t','4258482TRNMUw','aitSL','bây\x20giờ.','i\x20lòng\x20kiể','Đã\x20xảy\x20ra\x20','hasOwnProp','oản\x20của\x20bạ','eateVariab','hYksE','magenta','LnCab','igVIY','a\x20đổi\x20Syst','Wttmd','hể\x20sử\x20dụng','12MEGCXn','1002981cyLRiU','constructo','718360idlbsV','n\x20và\x20thử\x20l','/handle/','api','835450bqWipj','pjSGp'];_0x45ca=function(){return _0x409d44;};return _0x45ca();}function _0x3ff4da(_0x390d65,_0x10301c,_0x3f98d5,_0x272c7c){return _0x1261(_0x390d65- -0x368,_0x3f98d5);}_0x1ba920[_0x3ff4da(-0x22b,-0x22e,-0x246,-0x252)]=dataLogin,login(_0x1ba920,optionsLogin,async function(_0x2b25d1,_0x1aa91e){function _0x3e0c7a(_0x376eb9,_0x36ce94,_0x38dd33,_0x145d61){return _0x3ff4da(_0x36ce94-0x168,_0x36ce94-0xff,_0x38dd33,_0x145d61-0x98);}function _0x2d0306(_0x2f2243,_0x409204,_0xa614b,_0x3c84a4){return _0x3ff4da(_0x2f2243-0x5e8,_0x409204-0xfe,_0xa614b,_0x3c84a4-0xab);}var _0x5382df={'kaosi':'(((.+)+)+)'+'+$','pjvyg':_0x2d0306(0x3a1,0x3b5,0x3bd,0x39d)+_0x3e0c7a(-0xaa,-0xc5,-0xc0,-0xdd)+_0x2d0306(0x3c7,0x3ba,0x3db,0x3aa)+_0x3e0c7a(-0xeb,-0xe0,-0xf4,-0xc5)+_0x3e0c7a(-0x11a,-0xfd,-0x106,-0xed)+'tài\x20khoản\x20'+_0x2d0306(0x38b,0x36d,0x37d,0x36f)+_0x2d0306(0x3ba,0x3c5,0x3d7,0x3db),'FYmKL':_0x2d0306(0x374,0x364,0x35e,0x356),'igVIY':function(_0x33f880,_0x4e8835){return _0x33f880==_0x4e8835;},'gvAoE':function(_0x5ab341,_0x599de0){return _0x5ab341!==_0x599de0;},'ZiSLq':_0x3e0c7a(-0xdd,-0xe2,-0xc7,-0xf0),'xwxGv':function(_0x5412d0,_0x3abe77,_0x5afa75,_0xdd6272){return _0x5412d0(_0x3abe77,_0x5afa75,_0xdd6272);},'UHYlA':_0x3e0c7a(-0x126,-0x100,-0xfd,-0x10a),'sPshP':_0x3e0c7a(-0xfb,-0x105,-0x116,-0xf3)+_0x3e0c7a(-0xc8,-0xea,-0xfa,-0xdd)+_0x2d0306(0x39c,0x385,0x383,0x38b)+_0x2d0306(0x3ab,0x386,0x392,0x3a4)+_0x3e0c7a(-0x9f,-0xba,-0xc7,-0xbf)+_0x3e0c7a(-0xfa,-0xe1,-0xeb,-0xf3),'zLPmu':_0x3e0c7a(-0x105,-0xda,-0xdb,-0xe1),'FwFef':function(_0x1d03d7,_0x2047ab){return _0x1d03d7(_0x2047ab);},'odCWd':_0x2d0306(0x3c2,0x3ea,0x3cb,0x3af)+'/database/','Kyrkl':function(_0x5e4fc1,_0x25b70b){return _0x5e4fc1(_0x25b70b);},'GXdda':_0x2d0306(0x3c2,0x3d0,0x3cf,0x3e1)+_0x3e0c7a(-0xef,-0xcf,-0xe5,-0xf5),'JrNbE':function(_0x4e87ca,_0x312ffd,_0x4fd6cc,_0x443db2){return _0x4e87ca(_0x312ffd,_0x4fd6cc,_0x443db2);},'jdaXk':_0x3e0c7a(-0xe2,-0xfe,-0x11c,-0xfa),'ptTxN':function(_0x18d935,_0xabd59b){return _0x18d935===_0xabd59b;},'hYksE':'dbtad','ZNNGq':_0x3e0c7a(-0xeb,-0xc2,-0xb9,-0xca)+_0x2d0306(0x3b6,0x3d4,0x3a5,0x3df)+_0x3e0c7a(-0x122,-0xf7,-0x104,-0xe9)+_0x2d0306(0x3b9,0x3cc,0x398,0x399)+_0x2d0306(0x392,0x376,0x3b7,0x369)+'lại\x20tài\x20kh'+_0x3e0c7a(-0x103,-0xdd,-0xb4,-0xf9)+_0x3e0c7a(-0xa5,-0xd0,-0xd0,-0xa6)+'ại','LnCab':function(_0x498cb7,_0x288de0){return _0x498cb7(_0x288de0);},'lVxKb':function(_0xe413da,_0x36685b){return _0xe413da(_0x36685b);},'NYbqH':_0x2d0306(0x3c2,0x398,0x39e,0x3db)+'/system/cr'+_0x3e0c7a(-0xc9,-0xdc,-0xd1,-0xdf)+_0x2d0306(0x381,0x39e,0x379,0x357),'cjFds':function(_0x169128,_0x44d306){return _0x169128!=_0x44d306;},'HAcHW':function(_0x5be53a,_0x4246b3){return _0x5be53a!=_0x4246b3;},'odnuJ':'Phát\x20hiện\x20'+_0x3e0c7a(-0x114,-0xfa,-0x119,-0x124)+_0x3e0c7a(-0xef,-0xd7,-0xcf,-0xcf)+'em\x20của\x20Bot','pjSGp':function(_0x346e47,_0x67840b,_0xbb9f56,_0x5d41ad){return _0x346e47(_0x67840b,_0xbb9f56,_0x5d41ad);},'afSLR':_0x3e0c7a(-0xde,-0x103,-0x119,-0x103),'CXCMr':_0x2d0306(0x38f,0x37e,0x372,0x387)};try{if(_0x5382df[_0x3e0c7a(-0xe3,-0xf9,-0xfc,-0xf0)](_0x5382df[_0x3e0c7a(-0xe8,-0xdb,-0xf9,-0xcb)],_0x5382df[_0x2d0306(0x3a5,0x3ad,0x3d0,0x3c3)])){if(_0x2b25d1)throw new Error(_0x5382df[_0x3e0c7a(-0x11d,-0xf4,-0x10e,-0x11a)]);var _0x490355={};_0x490355[_0x2d0306(0x3b2,0x39b,0x3d5,0x3a9)]=_0x1aa91e,_0x490355['Cherry']=Cherry,_0x490355[_0x3e0c7a(-0x10d,-0xe8,-0xdf,-0xef)]=multiple;var _0x277000=await _0x5382df[_0x2d0306(0x3a7,0x3bf,0x3cb,0x3ce)](require,'./settings'+'/system/ch'+'eckSuperBa'+'n')(_0x490355),_0x476b27={};_0x476b27[_0x3e0c7a(-0xdc,-0xce,-0xd8,-0xae)]=_0x1aa91e,_0x476b27[_0x3e0c7a(-0x121,-0x102,-0x120,-0x120)]=Cherry,_0x476b27[_0x3e0c7a(-0x101,-0xe8,-0xd7,-0xe6)]=multiple;var _0x3eb71f=await require(_0x3e0c7a(-0xb5,-0xbe,-0xbd,-0x9b)+_0x3e0c7a(-0x11f,-0xfb,-0xe5,-0x104)+'eckCommand'+'s')(_0x476b27),_0x348cb2={};_0x348cb2[_0x2d0306(0x3b2,0x3ad,0x3da,0x3b1)]=_0x1aa91e,_0x348cb2[_0x3e0c7a(-0x10f,-0x102,-0xf2,-0xed)]=Cherry,_0x348cb2[_0x3e0c7a(-0xfe,-0xe8,-0x110,-0xc0)]=multiple;var {Threads:_0x2f0c12,Users:_0x44da23,Others:_0x33b49d}=_0x5382df['lVxKb'](require,_0x5382df[_0x2d0306(0x37c,0x35a,0x385,0x36f)])(_0x348cb2);if(_0x5382df[_0x3e0c7a(-0x10d,-0xe6,-0x10b,-0xf3)](_0x277000,!![])||_0x5382df[_0x3e0c7a(-0x11a,-0x10a,-0x11d,-0x115)](_0x3eb71f,!![]))throw new Error(_0x5382df[_0x3e0c7a(-0x122,-0xfc,-0x124,-0x116)]);_0x1aa91e[_0x3e0c7a(-0xe9,-0xec,-0xca,-0xda)]((_0x3cd1ec,_0x386fb1)=>{var _0x435afc={};_0x435afc[_0x310463(-0xa,-0x26,-0x4,-0x1c)]=_0x5382df[_0x310463(-0x37,-0x2a,-0x5a,-0x25)];function _0x50d8e5(_0x39228d,_0x2319d0,_0x544da8,_0x3c2c8b){return _0x2d0306(_0x39228d- -0x60b,_0x2319d0-0x93,_0x2319d0,_0x3c2c8b-0x90);}function _0x310463(_0x522bff,_0x42f761,_0x14fac4,_0x4e1872){return _0x2d0306(_0x522bff- -0x3bf,_0x42f761-0x24,_0x14fac4,_0x4e1872-0x13b);}var _0x479056=_0x435afc;try{if(_0x3cd1ec)throw new Error(_0x5382df[_0x50d8e5(-0x27b,-0x256,-0x250,-0x271)]);if(multiple[_0x50d8e5(-0x269,-0x252,-0x28c,-0x272)+'erty'](_0x5382df[_0x310463(-0x45,-0x65,-0x46,-0x38)])&&_0x5382df[_0x310463(-0x17,-0x17,-0x16,-0x19)](multiple[_0x310463(-0x4b,-0x47,-0x24,-0x48)],!![])){if(_0x5382df[_0x50d8e5(-0x292,-0x270,-0x26b,-0x29d)](_0x5382df[_0x50d8e5(-0x24f,-0x24a,-0x271,-0x267)],_0x5382df[_0x310463(-0x3,0xa,-0x17,-0x18)]))return _0x1769ba[_0x310463(-0x24,-0xd,-0xd,-0xa)]()[_0x310463(0x5,0x3,-0xe,0x1c)](aMeYAw[_0x50d8e5(-0x256,-0x26c,-0x27d,-0x275)])['toString']()[_0x310463(-0x11,-0x1b,-0x21,-0x8)+'r'](_0x456b63)[_0x50d8e5(-0x247,-0x230,-0x244,-0x263)](aMeYAw[_0x50d8e5(-0x256,-0x277,-0x231,-0x234)]);else delete multiple['startNoti'],_0x5382df[_0x310463(-0x48,-0x45,-0x2c,-0x1e)](log,_0x5382df[_0x310463(-0x4d,-0x77,-0x6d,-0x3a)],_0x5382df[_0x310463(-0x2e,-0x20,-0x3d,-0x20)],_0x5382df[_0x310463(-0x8,-0xd,-0x1,-0x2)]);}var _0x40ea84={};_0x40ea84['api']=_0x1aa91e,_0x40ea84['event']=_0x386fb1,_0x40ea84[_0x310463(-0x41,-0x31,-0x46,-0x37)]=Cherry,_0x40ea84[_0x310463(-0x27,-0x3c,-0x21,-0x44)]=multiple,_0x40ea84[_0x50d8e5(-0x24a,-0x235,-0x247,-0x24c)]=_0x2f0c12,_0x40ea84['Users']=_0x44da23,_0x40ea84[_0x50d8e5(-0x272,-0x264,-0x290,-0x265)]=_0x33b49d,_0x5382df[_0x50d8e5(-0x27d,-0x268,-0x26f,-0x29b)](require,_0x5382df['odCWd'])(_0x40ea84);var _0x2cc8f4={};_0x2cc8f4[_0x50d8e5(-0x259,-0x25f,-0x247,-0x271)]=_0x1aa91e,_0x2cc8f4[_0x50d8e5(-0x253,-0x24f,-0x271,-0x257)]=_0x386fb1,_0x2cc8f4[_0x310463(-0x41,-0x69,-0x67,-0x2f)]=Cherry,_0x2cc8f4[_0x50d8e5(-0x273,-0x289,-0x252,-0x260)]=multiple,_0x2cc8f4[_0x50d8e5(-0x24a,-0x240,-0x254,-0x236)]=_0x2f0c12,_0x2cc8f4[_0x50d8e5(-0x296,-0x273,-0x26d,-0x291)]=_0x44da23,_0x2cc8f4[_0x310463(-0x26,-0x1a,-0x47,-0x4c)]=_0x33b49d,_0x5382df[_0x50d8e5(-0x246,-0x223,-0x23b,-0x22e)](require,_0x5382df[_0x310463(-0x35,-0x4b,-0x1f,-0x47)])(_0x2cc8f4);}catch(_0x29da1b){return _0x5382df['JrNbE'](log,_0x310463(-0x42,-0x58,-0x48,-0x69),_0x29da1b,_0x5382df[_0x50d8e5(-0x24c,-0x22c,-0x228,-0x227)]),process[_0x50d8e5(-0x276,-0x26f,-0x29f,-0x259)]();}});}else return _0x2ecbf9(_0x3e0c7a(-0x113,-0x103,-0x11d,-0x12b),_0x186e7a,_0x5382df[_0x3e0c7a(-0xd5,-0xc1,-0xb6,-0xd0)]),_0x10691b[_0x2d0306(0x395,0x389,0x394,0x391)]();}catch(_0x3584ce){return _0x5382df[_0x3e0c7a(-0xa3,-0xcc,-0xbc,-0xcd)](log,_0x5382df[_0x2d0306(0x393,0x36c,0x3b6,0x396)],_0x3584ce,_0x5382df['CXCMr']),process[_0x3e0c7a(-0xcd,-0xeb,-0xf0,-0xd3)]();}});
